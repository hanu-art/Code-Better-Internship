                                                   qwestion-5 



1. Retrieve the names and locations of restaurants with a rating of 4.5 or higher.
SELECT Name, City 
FROM Restaurants 
WHERE Rating >= 4.5;

2. Find the total number of orders placed by each customer
SELECT c.FirstName, c.LastName, COUNT(o.OrderID) AS TotalOrders
FROM Customers c
LEFT JOIN Orders o ON c.CustomerID = o.CustomerID
GROUP BY c.CustomerID;

3. List all restaurants offering "Italian" cuisine in "Mumbai"
SELECT Name, City 
FROM Restaurants
WHERE CuisineType = 'Italian' AND City = 'Mumbai';

4. Calculate the total revenue generated by each restaurant from completed orders.
SELECT r.Name, SUM(o.OrderAmount) AS TotalRevenue
FROM Restaurants r
JOIN Orders o ON r.RestaurantID = o.RestaurantID
WHERE o.OrderStatus = 'Delivered'
GROUP BY r.RestaurantID;

5. Retrieve the most recent order placed by each customer.
SELECT o.CustomerID, o.OrderID, o.OrderDate, o.OrderAmount
FROM Orders o
WHERE o.OrderDate = (SELECT MAX(OrderDate) FROM Orders WHERE CustomerID = o.CustomerID);

6. List customers who have not placed any orders yet.
SELECT FirstName, LastName
FROM Customers
WHERE CustomerID NOT IN (SELECT DISTINCT CustomerID FROM Orders);

7. Identify the most reviewed restaurants.
SELECT r.Name, COUNT(rev.ReviewID) AS ReviewCount
FROM Restaurants r
JOIN Reviews rev ON r.RestaurantID = rev.RestaurantID
GROUP BY r.RestaurantID
ORDER BY ReviewCount DESC
LIMIT 1;

8. Find the most preferred payment method.
SELECT PaymentMethod, COUNT(PaymentID) AS MethodCount
FROM Payments
GROUP BY PaymentMethod
ORDER BY MethodCount DESC
LIMIT 1;

9. List the top 5 restaurants by total revenue.
SELECT r.Name, SUM(o.OrderAmount) AS TotalRevenue
FROM Restaurants r
JOIN Orders o ON r.RestaurantID = o.RestaurantID
WHERE o.OrderStatus = 'Delivered'
GROUP BY r.RestaurantID
ORDER BY TotalRevenue DESC
LIMIT 5;

10. Show the details of all cancelled orders along with the customer's and restaurant's names 
SELECT o.OrderID, o.OrderDate, o.OrderAmount, o.OrderStatus, c.FirstName, c.LastName, r.Name AS RestaurantName
FROM Orders o
JOIN Customers c ON o.CustomerID = c.CustomerID
JOIN Restaurants r ON o.RestaurantID = r.RestaurantID
WHERE o.OrderStatus = 'Cancelled';

